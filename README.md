<div align='center'>

# ğŸ† Lv.2 NLP Project : ìˆ˜ëŠ¥ ë¬¸ì œ í’€ì´ AI ëª¨ë¸ ìƒì„±
</div>

## âœï¸ ëŒ€íšŒ ì†Œê°œ
|   íŠ¹ì§•   | ì„¤ëª…                                                                                                     |
|:------:|--------------------------------------------------------------------------------------------------------|
| ëŒ€íšŒ ì£¼ì œ  | ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ìº í”„ AI-Tech 7ê¸° NLP íŠ¸ë™ì˜ level 2 Generation for NLP ëŒ€íšŒ<br/>                                        |
| ëŒ€íšŒ ì„¤ëª…  | í•œêµ­ì–´ì˜ íŠ¹ì„±ê³¼ ìˆ˜ëŠ¥ ì‹œí—˜ì˜ íŠ¹ì§•ì„ ë°”íƒ•ìœ¼ë¡œ ìˆ˜ëŠ¥ì— íŠ¹í™”ëœ AI ëª¨ë¸ì„ ìƒì„±í•˜ëŠ” í”„ë¡œì íŠ¸                                                      |
| ì§„í–‰ ê¸°ê°„  |2024ë…„ 11ì›” 11ì›” ~ 2024ë…„ 11ì›” 28ì¼|
| ë°ì´í„° êµ¬ì„± | í•™ìŠµë°ì´í„° ì…‹: KMMLU / MMMLU(Ko) / KLUE MRC ì¤‘ 2031ê°œ</br>í‰ê°€ë°ì´í„° ì…‹: ìˆ˜ëŠ¥í˜• ë¬¸ì œ + KMMLU / MMMLU(Ko) / KLUE MRC ì´ 869ê°œ |
| í‰ê°€ ì§€í‘œ  | ì •í™•ë„(Accuracy) = ëª¨ë¸ì´ ë§ì¶˜ ë¬¸ì œ ìˆ˜ / ì „ì²´ ë¬¸ì œ ìˆ˜ |

## ğŸ–ï¸ Leader Board
### ğŸ¥ˆ Public Leader Board (2ìœ„, ì´ 15íŒ€)
<img width="1216" alt="image" src="./assets/public_rank.png">
### ğŸ¥ˆ Priavate Leader Board (2ìœ„, ì´ 15íŒ€)
<img width="1216" alt="image" src="./assets/private_rank.png">

## ğŸ‘¨â€ğŸ’» Contributors
<table align='center'>
  <tr>
    <td align="center">
      <img src="https://github.com/yeseoLee.png" alt="ì´ì˜ˆì„œ" width="100" height="100" style="border-radius: 50%;"/><br>
      <a href="https://github.com/yeseoLee">
        <img src="https://img.shields.io/badge/%EC%9D%B4%EC%98%88%EC%84%9C-grey?style=for-the-badge&logo=github" alt="badge ì´ì˜ˆì„œ"/>
      </a>
    </td>
    <td align="center">
      <img src="https://github.com/Sujinkim-625.png" alt="ê¹€ìˆ˜ì§„" width="100" height="100" style="border-radius: 50%;"/><br>
      <a href="https://github.com/Sujinkim-625">
        <img src="https://img.shields.io/badge/%EA%B9%80%EC%88%98%EC%A7%84-grey?style=for-the-badge&logo=github" alt="badge ê¹€ìˆ˜ì§„"/>
      </a>
    </td>
    <td align="center">
      <img src="https://github.com/luckyvickyricky.png" alt="ê¹€ë¯¼ì„œ" width="100" height="100" style="border-radius: 50%;"/><br>
      <a href="https://github.com/luckyvickyricky">
        <img src="https://img.shields.io/badge/%EA%B9%80%EB%AF%BC%EC%84%9C-grey?style=for-the-badge&logo=github" alt="badge ê¹€ë¯¼ì„œ"/>
      </a>
    </td>
    <td align="center">
      <img src="https://github.com/koreannn.png" alt="í™ì„±ì¬" width="100" height="100" style="border-radius: 50%;"/><br>
      <a href="https://github.com/koreannn">
        <img src="https://img.shields.io/badge/%ED%99%8D%EC%84%B1%EC%9E%AC-grey?style=for-the-badge&logo=github" alt="badge í™ì„±ì¬"/>
      </a>
    </td>
    <td align="center">
      <img src="https://github.com/gayeon7877.png" alt="ì–‘ê°€ì—°" width="100" height="100" style="border-radius: 50%;"/><br>
      <a href="https://github.com/gayeon7877">
        <img src="https://img.shields.io/badge/%EC%96%91%EA%B0%80%EC%97%B0-grey?style=for-the-badge&logo=github" alt="badge ì–‘ê°€ì—°"/>
      </a>
    </td>
    <td align="center">
      <img src="https://github.com/hsmin9809.png" alt="í™ì„±ë¯¼" width="100" height="100" style="border-radius: 50%;"/><br>
      <a href="https://github.com/hsmin9809">
        <img src="https://img.shields.io/badge/%ED%99%8D%EC%84%B1%EB%AF%BC-grey?style=for-the-badge&logo=github" alt="badge í™ì„±ë¯¼"/>
      </a>
    </td>
  </tr>
</table>

## ğŸ‘¼ ì—­í•  ë¶„ë‹´
| ì´ë¦„ | ì—­í•                                                                                           |
| --- |---------------------------------------------------------------------------------------------|
| ê¹€ë¯¼ì„œ | ìµœì í™” ì†”ë£¨ì…˜(DeepSpeed), ì–‘ìí™”(Optimizer Quantization), ë‚œì´ë„ ê¸°ë°˜ ë°ì´í„° ì¦ê°•                              |
| ê¹€ìˆ˜ì§„ | EDA(êµ­ì–´ì˜ì—­ê³¼ ì‚¬íšŒì˜ì—­ ì°¨ì´ ë¶„ì„), ë°ì´í„° ìˆ˜ì§‘, LLMì„ í™œìš©í•œ ë°ì´í„° ì¦ê°•, í”„ë¡¬í”„íŠ¸ ì‹¤í—˜                                     |
| ì–‘ê°€ì—° | EDA(êµ­ì–´ì˜ì—­ê³¼ ì‚¬íšŒì˜ì—­ ì°¨ì´ ë¶„ì„), ë°ì´í„° ìˆ˜ì§‘, RAG êµ¬í˜„(Dense Retrieval)                                      |
| ì´ì˜ˆì„œ | ë©”ëª¨ë¦¬/ì†ë„ ìµœì í™”, ì–‘ìí™”(BitsAndBytes, GPTQ), ë°ì´í„° ìˆ˜ì§‘, ë°ì´í„° ì •ì œ, RAG êµ¬í˜„(Elastic Search, Reranker, RAFT) |
| í™ì„±ë¯¼ | EDA(ë°ì´í„° ì¶œì²˜ ê¸°ë°˜ ë¶„ì„), LLMì„ í™œìš©í•œ ë°ì´í„° ì¦ê°•                                                          |
| í™ì„±ì¬ | EDA(êµ­ì–´ì˜ì—­ê³¼ ì‚¬íšŒì˜ì—­ ì°¨ì´ ë¶„ì„), streamlit ì‹œê°í™”                                                        |

## ğŸ“ƒ Results
<img width="1000" alt="image" src="./assets/final_result.png">

## ğŸ› ï¸**Dependencies**
```
# CUDA Version: 12.2
# Ubuntu 20.04.6
# python 3.10.13

# Deep Learning
auto_gptq==0.7.1
bitsandbytes==0.44.1
evaluate==0.4.3
huggingface-hub==0.26.2
numpy==2.0.0
optimum==1.23.3
peft==0.5.0
scikit-learn==1.5.2
torch==2.5.1 # 2.5.1+cu124
tqdm==4.67.0
transformers==4.46.2
trl==0.12.0
wandb==0.18.5

# RAG
elasticsearch==8.16.0
konlpy==0.6.0
rank-bm25==0.2.2
wikiextractor==3.0.6
faiss-cpu==1.9.0 # faiss-gpu==1.7.2

# Utils
beautifulsoup4==4.12.3
ipykernel==6.29.5
ipywidgets==8.1.5
loguru==0.7.2
matplotlib==3.9.2
python-dotenv==1.0.1
reportlab==4.2.5
streamlit==1.40.1
pdfminer.six==20240706

# Google Drive API
google-api-python-client==2.151.0
google-auth-httplib2==0.2.0
google-auth-oauthlib==1.2.1

# Automatically installed dependencies
# pandas==2.2.3
# pyarrow==18.0.0
# datasets==3.1.0
# safetensors==0.4.5
# scipy==1.14.1
# tqdm==4.67.0
# PyYAML==6.0.2
# requests==2.32.3

```
## ğŸ’¾ Usage
1. Setting
```
$ pip install -r requirements.txt
```
2. train & inference
```angular2html
$ python3 code/main.py
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
code
 â”£ rag
 â”ƒ â”£ data_process
 â”ƒ â”ƒ â”£ external_data.py
 â”ƒ â”ƒ â”— wiki_dump.py
 â”ƒ â”£ README.md
 â”ƒ â”£ __init__.py
 â”ƒ â”£ chunk_data.py
 â”ƒ â”£ dpr_data.py
 â”ƒ â”£ encoder.py
 â”ƒ â”£ index_runner.py
 â”ƒ â”£ indexers.py
 â”ƒ â”£ prepare_dense.py
 â”ƒ â”£ reranker.py
 â”ƒ â”£ retriever.py
 â”ƒ â”£ retriever_bm25.py
 â”ƒ â”£ retriever_elastic.py
 â”ƒ â”£ train.py
 â”ƒ â”£ trainer.py
 â”ƒ â”— utils.py
 â”£ utils
 â”ƒ â”£ __init__.py
 â”ƒ â”£ common.py
 â”ƒ â”£ gdrive_manager.py
 â”ƒ â”— hf_manager.py
 â”£ data_loaders.py
 â”£ inference.py
 â”£ labeling.py
 â”£ main.py
 â”£ model.py
 â”£ split.py
 â”— trainer.py
 data_aug
 â”£ add_CoT.py
 â”— aug_philo.py
 data_process
 â”£ crawling_gichulpass.py
 â”£ external_musr.py
 â”£ external_race.py
 â”£ external_sat_gaokao.py
 â”£ pdf_to_txt.py
 â”£ process_balance_choices.py
 â”£ process_formatting.py
 â”— process_google_translate.py
 data_viz
 â”£ csv2pdf.py
 â”£ labeling.py
 â”— streamlit_app.py
config
 â”£ sample
 â”ƒ â”£ config.yaml
 â”ƒ â”— env-sample.txt
 â”— elastic_setting.json
```
